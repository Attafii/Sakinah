<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sakinah</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="logo">
                <span class="arabic">ÿ≥ŸÉŸäŸÜÿ©</span>
                <span class="english">Sakinah</span>
            </h1>
            <p class="subtitle">Find peace through the Qur'an</p>
        </header>

        <!-- Tab Navigation -->
        <nav class="tabs">
            <button class="tab-button active" data-tab="random">
                <span class="tab-icon">üìñ</span>
                Random Ayah
            </button>
            <button class="tab-button" data-tab="ahadith">
                <span class="tab-icon">üïã</span>
                Ahadith
            </button>
            <button class="tab-button" data-tab="ai-guide">
                <span class="tab-icon">ü§≤</span>
                AI Guide
            </button>
                <button class="tab-button" data-tab="favorites">
                    <span class="tab-icon">‚≠ê</span>
                    Favorites
                </button>
            <button class="tab-button" data-tab="settings">
                <span class="tab-icon">‚öôÔ∏è</span>
                Settings
            </button>
        </nav>

        <!-- Tab Content -->
        <main class="content">
            <!-- Random Ayah Tab -->
            <div class="tab-content active" id="random-tab">
                <div class="ayah-container">
                    <div class="ayah-loading" id="ayah-loading">
                        <div class="spinner"></div>
                        <p>Loading Ayah...</p>
                    </div>
                    <div class="ayah-content" id="ayah-content" style="display: none;">
                        <div class="ayah-arabic" id="ayah-arabic"></div>
                        <div class="ayah-translation" id="ayah-translation"></div>
                        <div class="ayah-reference" id="ayah-reference"></div>
                    </div>
                </div>
                <div style="display:flex; gap:8px; justify-content:center; margin-top:12px; flex-wrap:wrap;">
                    <button class="refresh-button" id="refresh-ayah" aria-label="New Ayah">
                    <span>üîÑ</span>
                    New Ayah
                    </button>
                    <button class="secondary-button" id="save-favorite" aria-label="Save Ayah to favorites">‚≠ê Save</button>
                    <button class="secondary-button" id="explain-ayah" aria-label="Explain this Ayah with AI" style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:white;">ü§ñ Explain</button>
                </div>
                <div id="ayah-explanation" style="display:none; margin-top:16px; padding:16px; background:#f0f8ff; border-radius:10px; border-left:4px solid #667eea;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                        <h4 style="margin:0; color:#667eea;">ü§ñ AI Explanation</h4>
                        <button id="close-ayah-explanation" style="background:none; border:none; cursor:pointer; font-size:18px; color:#666;">‚úñ</button>
                    </div>
                    <div id="ayah-explanation-content" style="line-height:1.8; color:#333;"></div>
                </div>
            </div>

            <!-- AI Guide Tab -->
            <div class="tab-content" id="ai-guide-tab">
                <div class="ai-guide-container">
                    <h3>How are you feeling?</h3>
                    <p class="guide-instruction">
                        Describe your current emotional or spiritual state, and we'll suggest the most relevant Ayah for you.
                    </p>
                    <textarea 
                        id="emotional-state" 
                        placeholder="I'm feeling anxious about my future..."
                        maxlength="500"
                    ></textarea>
                    <div class="char-count">
                        <span id="char-count">0</span>/500
                    </div>
                    <!-- Detected emotions indicator (click a tag to request a verse for that emotion) -->
                    <div id="ai-detected" class="ai-detected" style="display:none; margin-top:8px; font-size:0.9em; color:#2b6cb0;">
                        <span id="ai-detected-label" style="display:block; font-weight:600; margin-bottom:6px;">Detected:</span>
                        <div id="ai-detected-chips" style="display:flex; gap:6px; flex-wrap:wrap;"></div>
                    </div>
                    <div class="char-count">
                        <span id="char-count">0</span>/500
                    </div>
                    <button class="guide-button" id="get-guidance">
                        Find Guidance
                    </button>
                    
                    <div class="ai-result" id="ai-result" style="display: none;">
                        <div class="suggested-ayah">
                            <h4>Suggested Ayah for you:</h4>
                            <div class="ayah-arabic" id="ai-ayah-arabic"></div>
                            <div class="ayah-translation" id="ai-ayah-translation"></div>
                            <div class="ayah-reference" id="ai-ayah-reference"></div>
                            <div class="ai-explanation" id="ai-explanation"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ahadith Tab -->
            <div class="tab-content" id="ahadith-tab">
                <div class="hadith-container">
                    <div style="display:flex; gap:8px; align-items:center; margin-bottom:10px;">
                        <input id="hadith-search" type="search" placeholder="Search Ahadith by keyword, tag, or source" style="flex:1; padding:8px; border-radius:6px; border:1px solid #ddd;" />
                        <button id="hadith-prev" class="secondary-button" aria-label="Previous Hadith">‚óÄ Prev</button>
                        <button id="hadith-random" class="secondary-button" aria-label="Random Hadith">üé≤ Random</button>
                        <button id="hadith-next" class="secondary-button" aria-label="Next Hadith">Next ‚ñ∂</button>
                    </div>

                    <div id="hadith-list" style="display:flex; flex-direction:column; gap:12px;">
                        <!-- hadith cards will render here -->
                    </div>

                    <div style="display:flex; gap:8px; justify-content:center; margin-top:12px; flex-wrap:wrap;">
                        <button class="secondary-button" id="save-hadith-favorite">‚≠ê Save Hadith</button>
                        <button class="secondary-button" id="explain-hadith" style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:white;">ü§ñ Explain</button>
                    </div>
                    <div id="hadith-explanation" style="display:none; margin-top:16px; padding:16px; background:#f0f8ff; border-radius:10px; border-left:4px solid #667eea;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                            <h4 style="margin:0; color:#667eea;">ü§ñ AI Explanation</h4>
                            <button id="close-hadith-explanation" style="background:none; border:none; cursor:pointer; font-size:18px; color:#666;">‚úñ</button>
                        </div>
                        <div id="hadith-explanation-content" style="line-height:1.8; color:#333;"></div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings-tab">
                <div class="settings-container">
                    <div class="setting-group">
                        <h3>Notifications</h3>
                        <label class="setting-item">
                            <input type="checkbox" id="notifications-enabled">
                            <span class="checkmark"></span>
                            Enable notifications
                        </label>
                        
                        <div class="notification-frequency" id="notification-settings">
                            <label class="setting-item">
                                <span class="setting-label">Frequency:</span>
                                <select id="notification-frequency">
                                    <option value="15">Every 15 minutes</option>
                                    <option value="30">Every 30 minutes</option>
                                    <option value="60" selected>Every hour</option>
                                    <option value="120">Every 2 hours</option>
                                    <option value="180">Every 3 hours</option>
                                    <option value="360">Every 6 hours</option>
                                    <option value="720">Every 12 hours</option>
                                    <option value="1440">Daily</option>
                                </select>
                            </label>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3>Display</h3>
                        <label class="setting-item">
                            <input type="checkbox" id="show-arabic" checked>
                            <span class="checkmark"></span>
                            Show Arabic text
                        </label>
                        
                        <label class="setting-item">
                            <input type="checkbox" id="show-translation" checked>
                            <span class="checkmark"></span>
                            Show English translation
                        </label>
                    </div>

                    <div class="setting-group">
                        <div style="display:flex; gap:8px; flex-wrap:wrap;">
                            <button class="options-button" id="open-options">
                                Open Advanced Settings
                            </button>
                            <button class="options-button" id="test-notification">
                                Test Notification
                            </button>
                            <button class="options-button" id="export-data">
                                Export Data
                            </button>
                            <button class="options-button" id="help-button">
                                Help
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>May Allah grant you peace and tranquility</p>
        </footer>
    </div>

    <script src="config.js"></script>
    <script src="ai.js"></script>
    <script src="favorites-analyzer.js"></script>
    <script src="popup.js"></script>
</body>
</html>