<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sakinah</title>
    <link rel="stylesheet" href="styles.css">
    <script src="lucide.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="logo">
                    <span class="arabic">ÿ≥ŸÉŸäŸÜÿ©</span>
                    <span class="english">Sakinah</span>
                </h1>
                <p class="subtitle" data-i18n="popup.subtitle">Find peace through the Qur'an</p>
            </div>
            <div class="language-toggle">
                <button class="lang-btn" data-lang="en" title="English">EN</button>
                <button class="lang-btn" data-lang="ar" title="ÿßŸÑÿπÿ±ÿ®Ÿäÿ©">ÿπ</button>
            </div>
        </header>

        <!-- Tab Navigation -->
        <nav class="tabs">
            <button class="tab-button active" data-tab="random">
                <span class="tab-icon"><i data-lucide="book-open"></i></span>
                <span data-i18n="popup.randomAyah">Random Ayah</span>
            </button>
            <button class="tab-button" data-tab="ahadith">
                <span class="tab-icon"><i data-lucide="building"></i></span>
                <span data-i18n="popup.ahadith">Ahadith</span>
            </button>
            <button class="tab-button" data-tab="ai-guide">
                <span class="tab-icon"><i data-lucide="sparkles"></i></span>
                <span data-i18n="popup.aiGuide">AI Guide</span>
            </button>
            <button class="tab-button" data-tab="favorites">
                <span class="tab-icon"><i data-lucide="heart"></i></span>
                <span data-i18n="popup.favorites">Favorites</span>
            </button>
            <button class="tab-button" data-tab="hifdh">
                <span class="tab-icon"><i data-lucide="target"></i></span>
                <span data-i18n="popup.hifdh">Hifdh</span>
            </button>
            <button class="tab-button" data-tab="settings">
                <span class="tab-icon"><i data-lucide="settings"></i></span>
                <span data-i18n="popup.settings">Settings</span>
            </button>
        </nav>

        <!-- Prayer Times Bar -->
        <div class="prayer-times-bar" id="prayer-times-bar">
            <div class="prayer-item" id="popup-prayer-fajr">
                <span class="name">Fajr</span>
                <span class="time">--:--</span>
            </div>
            <div class="prayer-item" id="popup-prayer-sunrise">
                <span class="name">Sunrise</span>
                <span class="time">--:--</span>
            </div>
            <div class="prayer-item" id="popup-prayer-dhuhr">
                <span class="name">Dhuhr</span>
                <span class="time">--:--</span>
            </div>
            <div class="prayer-item" id="popup-prayer-asr">
                <span class="name">Asr</span>
                <span class="time">--:--</span>
            </div>
            <div class="prayer-item" id="popup-prayer-maghrib">
                <span class="name">Maghrib</span>
                <span class="time">--:--</span>
            </div>
            <div class="prayer-item" id="popup-prayer-isha">
                <span class="name">Isha</span>
                <span class="time">--:--</span>
            </div>
        </div>

        <!-- Tab Content -->
        <main class="content">
            <!-- Random Ayah Tab -->
            <div class="tab-content active" id="random-tab">
                <div class="ayah-container">
                    <div class="ayah-loading" id="ayah-loading">
                        <div class="spinner"></div>
                        <p data-i18n="popup.loading">Loading Ayah...</p>
                    </div>
                    <div class="ayah-content" id="ayah-content" style="display: none;">
                        <div class="ayah-arabic" id="ayah-arabic"></div>
                        <div class="ayah-translation" id="ayah-translation"></div>
                        <div class="ayah-reference" id="ayah-reference"></div>
                    </div>
                </div>
                <div style="display:flex; gap:8px; justify-content:center; margin-top:12px; flex-wrap:wrap;">
                    <button class="refresh-button" id="refresh-ayah" aria-label="New Ayah">
                    <span><i data-lucide="refresh-cw"></i></span>
                    <span data-i18n="popup.refresh">New Ayah</span>
                    </button>
                    <button class="icon-button" id="save-favorite" aria-label="Save Ayah to favorites" title="Save to favorites"><i data-lucide="heart"></i></button>
                    <button class="secondary-button" id="explain-ayah" aria-label="Explain this Ayah with AI" style="background:linear-gradient(135deg, #A8EBD8 0%, #72BAAE 100%); color:white; border:none;"><i data-lucide="bot"></i> <span data-i18n="popup.explainAyah">Explain</span></button>
                </div>
                <div id="ayah-explanation" style="display:none; margin-top:16px; padding:16px; background:linear-gradient(135deg, rgba(168, 235, 216, 0.2) 0%, rgba(114, 186, 174, 0.15) 100%); border-radius:12px; border-left:4px solid #72BAAE;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                        <h4 style="margin:0; color:#2B8C7B; display:flex; align-items:center; gap:8px;"><i data-lucide="bot"></i> AI Explanation</h4>
                        <button id="close-ayah-explanation" style="background:none; border:none; cursor:pointer; font-size:18px; color:#666;"><i data-lucide="x"></i></button>
                    </div>
                    <div id="ayah-explanation-content" style="line-height:1.8; color:#333;"></div>
                </div>
            </div>

            <!-- AI Guide Tab - Chat Interface -->
            <div class="tab-content" id="ai-guide-tab">
                <div class="ai-guide-container" style="display:flex; flex-direction:column; height:100%;">
                    <!-- Header with clear button -->
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                        <h3 style="margin:0; color:#2B8C7B; display:flex; align-items:center; gap:8px;"><i data-lucide="sparkles"></i> <span data-i18n="aiGuide.title">AI Spiritual Guide</span></h3>
                        <div style="display:flex; gap:8px; align-items:center;">
                            <label style="display:flex; align-items:center; gap:4px; cursor:pointer; font-size:0.85em; color:#555;" title="Force responses in Arabic">
                                <input type="checkbox" id="arabic-mode-toggle" style="cursor:pointer;">
                                <span>ÿπÿ±ÿ®Ÿä</span>
                            </label>
                            <button id="clear-chat" class="secondary-button" style="padding:6px 12px; font-size:0.85em; display:flex; align-items:center; gap:4px;"><i data-lucide="trash-2"></i> <span data-i18n="common.clear">Clear Chat</span></button>
                        </div>
                    </div>
                    
                    <p class="guide-instruction" style="margin-bottom:12px; color:#666; font-size:0.9em;" data-i18n="aiGuide.placeholder">
                        Share what's on your mind, and I'll provide Islamic guidance and relevant Quranic verses.
                    </p>

                    <!-- Quick mood chips -->
                    <div id="mood-chips-container" style="margin-bottom:12px;">
                        <p style="font-size:0.85em; color:#888; margin-bottom:8px;">Quick topics:</p>
                        <div id="mood-chips" style="display:flex; flex-wrap:wrap; gap:6px;">
                            <button class="mood-chip" data-mood="anxious" style="padding:6px 12px; border:1.5px solid #72BAAE; border-radius:16px; background:white; color:#2B8C7B; cursor:pointer; font-size:0.85em; transition:all 0.2s ease; display:inline-flex; align-items:center; gap:4px;"><i data-lucide="alert-circle" style="width:14px; height:14px;"></i> Anxious</button>
                            <button class="mood-chip" data-mood="sad" style="padding:6px 12px; border:1.5px solid #72BAAE; border-radius:16px; background:white; color:#2B8C7B; cursor:pointer; font-size:0.85em; transition:all 0.2s ease; display:inline-flex; align-items:center; gap:4px;"><i data-lucide="cloud-rain" style="width:14px; height:14px;"></i> Sad</button>
                            <button class="mood-chip" data-mood="stressed" style="padding:6px 12px; border:1.5px solid #72BAAE; border-radius:16px; background:white; color:#2B8C7B; cursor:pointer; font-size:0.85em; transition:all 0.2s ease; display:inline-flex; align-items:center; gap:4px;"><i data-lucide="zap" style="width:14px; height:14px;"></i> Stressed</button>
                            <button class="mood-chip" data-mood="lonely" style="padding:6px 12px; border:1.5px solid #72BAAE; border-radius:16px; background:white; color:#2B8C7B; cursor:pointer; font-size:0.85em; transition:all 0.2s ease; display:inline-flex; align-items:center; gap:4px;"><i data-lucide="user" style="width:14px; height:14px;"></i> Lonely</button>
                            <button class="mood-chip" data-mood="seeking guidance" style="padding:6px 12px; border:1.5px solid #72BAAE; border-radius:16px; background:white; color:#2B8C7B; cursor:pointer; font-size:0.85em; transition:all 0.2s ease; display:inline-flex; align-items:center; gap:4px;"><i data-lucide="compass" style="width:14px; height:14px;"></i> Guidance</button>
                            <button class="mood-chip" data-mood="grateful" style="padding:6px 12px; border:1.5px solid #72BAAE; border-radius:16px; background:white; color:#2B8C7B; cursor:pointer; font-size:0.85em; transition:all 0.2s ease; display:inline-flex; align-items:center; gap:4px;"><i data-lucide="smile" style="width:14px; height:14px;"></i> Grateful</button>
                            <button class="mood-chip" data-mood="hopeless" style="padding:6px 12px; border:1.5px solid #72BAAE; border-radius:16px; background:white; color:#2B8C7B; cursor:pointer; font-size:0.85em; transition:all 0.2s ease; display:inline-flex; align-items:center; gap:4px;"><i data-lucide="frown" style="width:14px; height:14px;"></i> Hopeless</button>
                            <button class="mood-chip" data-mood="guilty" style="padding:6px 12px; border:1.5px solid #72BAAE; border-radius:16px; background:white; color:#2B8C7B; cursor:pointer; font-size:0.85em; transition:all 0.2s ease; display:inline-flex; align-items:center; gap:4px;"><i data-lucide="circle-minus" style="width:14px; height:14px;"></i> Guilty</button>
                        </div>
                    </div>

                    <!-- Chat messages container -->
                    <div id="chat-messages" style="flex:1; overflow-y:auto; min-height:200px; max-height:350px; padding:12px; background:linear-gradient(145deg, #f8faf9 0%, #fff 100%); border-radius:12px; border:1px solid rgba(114, 186, 174, 0.2); margin-bottom:12px;">
                        <!-- Welcome message -->
                        <div class="chat-message ai-message" style="margin-bottom:12px;">
                            <div style="background:linear-gradient(135deg, rgba(168, 235, 216, 0.3) 0%, rgba(114, 186, 174, 0.2) 100%); padding:12px 16px; border-radius:12px 12px 12px 0; max-width:90%;">
                                <p style="margin:0; color:#1a3a36; line-height:1.6;">
                                    ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖ Ÿàÿ±ÿ≠ŸÖÿ© ÿßŸÑŸÑŸá Ÿàÿ®ÿ±ŸÉÿßÿ™Ÿá ü§≤
                                </p>
                                <p style="margin:8px 0 0 0; color:#1a3a36; line-height:1.6;">
                                    Peace be upon you! I'm Sakinah, your AI spiritual guide. Share what's on your heart, and I'll help you find peace through the Quran and Islamic wisdom. How can I help you today?
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Input area -->
                    <div style="display:flex; flex-direction:column; gap:8px;">
                        <div style="display:flex; gap:8px; align-items:flex-end;">
                            <textarea 
                                id="emotional-state" 
                                placeholder="Type your message here... (Press Enter to send)"
                                data-i18n-placeholder="aiGuide.inputPlaceholder"
                                maxlength="1000"
                                rows="2"
                                style="flex:1; resize:none; padding:12px; border-radius:12px; border:2px solid rgba(114, 186, 174, 0.3); font-family:inherit; font-size:0.95em; transition:all 0.3s ease;"
                            ></textarea>
                            <button class="guide-button" id="get-guidance" style="padding:12px 20px; margin:0; white-space:nowrap; display:flex; align-items:center; gap:6px;">
                                <span data-i18n="aiGuide.askButton">Send</span> <i data-lucide="send"></i>
                            </button>
                        </div>
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <span style="font-size:0.8em; color:#888;"><span id="char-count">0</span>/1000</span>
                            <span style="font-size:0.75em; color:#aaa;">Powered by AI ‚Ä¢ Responses based on Islamic teachings</span>
                        </div>
                    </div>

                    <!-- Hidden elements for backward compatibility -->
                    <div id="ai-detected" style="display:none;"></div>
                    <div id="ai-detected-chips" style="display:none;"></div>
                    <div id="ai-result" style="display:none;">
                        <div id="ai-ayah-arabic"></div>
                        <div id="ai-ayah-translation"></div>
                        <div id="ai-ayah-reference"></div>
                        <div id="ai-explanation"></div>
                    </div>
                </div>
            </div>

            <!-- Ahadith Tab -->
            <div class="tab-content" id="ahadith-tab">
                <div class="hadith-container">
                    <!-- Collection Filter -->
                    <div style="margin-bottom:12px; display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
                        <label for="hadith-collection-filter" style="font-size:0.9em; color:#2B8C7B; font-weight:600;" data-i18n="hadith.title">Collection:</label>
                        <select id="hadith-collection-filter" style="flex:1; padding:8px 12px; border-radius:10px; border:2px solid rgba(114, 186, 174, 0.3); background:white; cursor:pointer; font-size:0.9em;">
                            <option value="all" data-i18n="hadith.allCollections">All Collections</option>
                            <option value="bukhari" data-i18n="hadith.bukhari">Sahih al-Bukhari</option>
                            <option value="muslim" data-i18n="hadith.muslim">Sahih Muslim</option>
                            <option value="nawawi" data-i18n="hadith.nawawi40">40 Hadith Nawawi</option>
                            <option value="qudsi" data-i18n="hadith.qudsi40">40 Hadith Qudsi</option>
                            <option value="shahwaliullah" data-i18n="hadith.shahwaliullah40">40 Hadith Shah Waliullah</option>
                        </select>
                    </div>
                    
                    <div class="ayah-container">
                        <div class="ayah-loading" id="hadith-loading">
                            <div class="spinner"></div>
                            <p data-i18n="popup.loading">Loading Hadith...</p>
                        </div>
                        <div class="ayah-content" id="hadith-content" style="display: none;">
                            <div class="ayah-arabic" id="hadith-arabic"></div>
                            <div class="ayah-translation" id="hadith-translation"></div>
                            <div class="ayah-reference" id="hadith-reference"></div>
                        </div>
                    </div>

                    <div style="display:flex; gap:8px; justify-content:center; margin-top:12px; flex-wrap:wrap; align-items:center;">
                        <button class="refresh-button" id="hadith-random" aria-label="New Hadith">
                            <span><i data-lucide="refresh-cw"></i></span>
                            <span data-i18n="popup.refresh">New Hadith</span>
                        </button>
                        <button class="icon-button" id="save-hadith-favorite" aria-label="Save Hadith to favorites" title="Save to favorites"><i data-lucide="heart"></i></button>
                        <button class="secondary-button" id="explain-hadith" style="background:linear-gradient(135deg, #A8EBD8 0%, #72BAAE 100%); color:white; border:none; display:flex; align-items:center; gap:6px;"><i data-lucide="bot"></i> <span data-i18n="popup.explainAyah">Explain</span></button>
                    </div>
                    <div id="hadith-explanation" style="display:none; margin-top:16px; padding:16px; background:linear-gradient(135deg, rgba(168, 235, 216, 0.2) 0%, rgba(114, 186, 174, 0.15) 100%); border-radius:12px; border-left:4px solid #72BAAE;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                            <h4 style="margin:0; color:#2B8C7B; display:flex; align-items:center; gap:8px;"><i data-lucide="bot"></i> <span data-i18n="ayah.tafsir">AI Explanation</span></h4>
                            <button id="close-hadith-explanation" style="background:none; border:none; cursor:pointer; font-size:18px; color:#666;"><i data-lucide="x"></i></button>
                        </div>
                        <div id="hadith-explanation-content" style="line-height:1.8; color:#333;"></div>
                    </div>
                </div>
            </div>

            <!-- Hifdh (Memorization) Tab -->
            <div class="tab-content" id="hifdh-tab">
                <div class="hifdh-container">
                    <!-- Header -->
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
                        <h3 style="color:#2B8C7B; margin:0; display:flex; align-items:center; gap:8px;"><i data-lucide="target"></i> <span data-i18n="hifdh.title">Hifdh ‚Äî Memorize the Qur'an</span></h3>
                        <div id="hifdh-stats" style="font-size:0.8em; color:#666; background:rgba(114,186,174,0.1); padding:4px 10px; border-radius:12px;">
                            <span id="memorized-count">0</span> <span data-i18n="hifdh.completed">memorized</span>
                        </div>
                    </div>

                    <!-- Surah Selection -->
                    <div style="display:flex; gap:8px; margin-bottom:12px; align-items:center;">
                        <label for="surah-select" style="font-size:0.9em; color:#2B8C7B; font-weight:600; white-space:nowrap;" data-i18n="ayah.surah">Surah:</label>
                        <select id="surah-select" style="flex:1; padding:10px 14px; border-radius:12px; border:2px solid rgba(114, 186, 174, 0.3); background:white; cursor:pointer; font-size:0.95em;"></select>
                    </div>

                    <!-- Mode Buttons -->
                    <div style="display:flex; gap:8px; margin-bottom:12px;">
                        <button id="hifdh-learn" class="hifdh-mode-btn active" style="flex:1; padding:10px; border:2px solid #72BAAE; border-radius:10px; background:linear-gradient(135deg, #A8EBD8 0%, #72BAAE 100%); color:white; font-weight:600; cursor:pointer; transition:all 0.3s ease; display:flex; align-items:center; justify-content:center; gap:6px;">
                            <i data-lucide="book-open"></i> <span data-i18n="hifdh.memorize">Learn</span>
                        </button>
                        <button id="hifdh-quiz" class="hifdh-mode-btn" style="flex:1; padding:10px; border:2px solid rgba(114,186,174,0.3); border-radius:10px; background:white; color:#2B8C7B; font-weight:600; cursor:pointer; transition:all 0.3s ease; display:flex; align-items:center; justify-content:center; gap:6px;">
                            <i data-lucide="clipboard-check"></i> <span data-i18n="hifdh.quiz">Quiz</span>
                        </button>
                        <button id="hifdh-listen" class="hifdh-mode-btn" style="flex:1; padding:10px; border:2px solid rgba(114,186,174,0.3); border-radius:10px; background:white; color:#2B8C7B; font-weight:600; cursor:pointer; transition:all 0.3s ease; display:flex; align-items:center; justify-content:center; gap:6px;">
                            <i data-lucide="headphones"></i> <span data-i18n="hifdh.listen">Listen</span>
                        </button>
                    </div>

                    <!-- Progress Bar -->
                    <div style="margin-bottom:12px;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:4px;">
                            <span id="hifdh-progress" style="font-size:0.85em; color:#2B8C7B; font-weight:500;">Select a Surah to begin</span>
                            <span id="hifdh-percentage" style="font-size:0.85em; color:#72BAAE; font-weight:600;">0%</span>
                        </div>
                        <div style="height:6px; background:rgba(114,186,174,0.2); border-radius:3px; overflow:hidden;">
                            <div id="hifdh-progress-bar" style="height:100%; width:0%; background:linear-gradient(90deg, #A8EBD8, #72BAAE); border-radius:3px; transition:width 0.3s ease;"></div>
                        </div>
                    </div>

                    <!-- Main Display Area -->
                    <div id="hifdh-display" style="border:2px solid rgba(114, 186, 174, 0.2); padding:20px; border-radius:16px; background:linear-gradient(145deg, #fff 0%, #f8faf9 100%); box-shadow:0 4px 15px rgba(114, 186, 174, 0.1); min-height:180px; position:relative;">
                        
                        <!-- Verse Number Badge -->
                        <div id="hifdh-verse-badge" style="position:absolute; top:-10px; right:16px; background:linear-gradient(135deg, #72BAAE, #2B8C7B); color:white; padding:4px 12px; border-radius:12px; font-size:0.8em; font-weight:600; box-shadow:0 2px 8px rgba(43,140,123,0.3);">
                            Ayah 1
                        </div>

                        <!-- Arabic Text -->
                        <div id="hifdh-arabic" style="direction:rtl; font-size:1.4em; font-family:'Scheherazade', 'Amiri', 'Traditional Arabic', serif; margin-bottom:16px; color:#1a3a36; line-height:2; text-align:center; padding:10px 0;">
                            Select a Surah to begin memorizing
                        </div>

                        <!-- Translation -->
                        <div id="hifdh-translation" style="font-size:0.9em; color:#555; line-height:1.7; text-align:center; padding:12px; background:rgba(114,186,174,0.08); border-radius:10px; border-left:3px solid #72BAAE;"></div>

                        <!-- Quiz Area - Multiple Choice Game -->
                        <div id="hifdh-quiz-area" style="display:none; margin-top:16px;">
                            <!-- Quiz Score Header -->
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; padding:12px 16px; background:linear-gradient(135deg, rgba(114,186,174,0.15) 0%, rgba(168,235,216,0.1) 100%); border-radius:12px;">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <i data-lucide="gamepad-2" style="width:24px; height:24px;"></i>
                                    <span style="font-weight:600; color:#2B8C7B;" data-i18n="hifdh.quizGame">Quiz Game</span>
                                </div>
                                <div style="display:flex; gap:16px; font-size:0.9em;">
                                    <div style="text-align:center;">
                                        <div id="quiz-score" style="font-size:1.3em; font-weight:700; color:#28a745;">0</div>
                                        <div style="color:#666; font-size:0.8em;" data-i18n="hifdh.score">Score</div>
                                    </div>
                                    <div style="text-align:center;">
                                        <div id="quiz-streak" style="font-size:1.3em; font-weight:700; color:#ffc107;">0</div>
                                        <div style="color:#666; font-size:0.8em;" data-i18n="hifdh.streak">üî• Streak</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Question -->
                            <div style="text-align:center; margin-bottom:16px;">
                                <p style="margin:0 0 8px 0; font-size:0.9em; color:#666;" data-i18n="hifdh.quizPrompt">Complete the verse - what comes next?</p>
                                <div id="quiz-arabic-display" style="direction:rtl; font-size:1.4em; font-family:'Scheherazade', 'Amiri', serif; color:#1a3a36; line-height:1.8; padding:16px; background:rgba(114,186,174,0.08); border-radius:12px; border:2px dashed rgba(114,186,174,0.3);">
                                    <span id="quiz-prompt"></span><span style="color:#72BAAE; font-weight:bold;"> ___</span>
                                </div>
                            </div>

                            <!-- Multiple Choice Options -->
                            <div id="quiz-options" style="display:flex; flex-direction:column; gap:10px;">
                                <button class="quiz-option" data-option="0" style="width:100%; padding:14px 16px; border:2px solid rgba(114,186,174,0.3); border-radius:12px; background:white; text-align:right; direction:rtl; cursor:pointer; transition:all 0.3s ease; font-size:1.1em; line-height:1.6; font-family:'Scheherazade', 'Amiri', serif;">
                                    <span class="option-letter" style="display:inline-block; width:28px; height:28px; line-height:28px; text-align:center; background:linear-gradient(135deg, #72BAAE, #2B8C7B); color:white; border-radius:50%; margin-left:12px; font-weight:600; font-family:system-ui;">A</span>
                                    <span class="option-text">...</span>
                                </button>
                                <button class="quiz-option" data-option="1" style="width:100%; padding:14px 16px; border:2px solid rgba(114,186,174,0.3); border-radius:12px; background:white; text-align:right; direction:rtl; cursor:pointer; transition:all 0.3s ease; font-size:1.1em; line-height:1.6; font-family:'Scheherazade', 'Amiri', serif;">
                                    <span class="option-letter" style="display:inline-block; width:28px; height:28px; line-height:28px; text-align:center; background:linear-gradient(135deg, #72BAAE, #2B8C7B); color:white; border-radius:50%; margin-left:12px; font-weight:600; font-family:system-ui;">B</span>
                                    <span class="option-text">...</span>
                                </button>
                                <button class="quiz-option" data-option="2" style="width:100%; padding:14px 16px; border:2px solid rgba(114,186,174,0.3); border-radius:12px; background:white; text-align:right; direction:rtl; cursor:pointer; transition:all 0.3s ease; font-size:1.1em; line-height:1.6; font-family:'Scheherazade', 'Amiri', serif;">
                                    <span class="option-letter" style="display:inline-block; width:28px; height:28px; line-height:28px; text-align:center; background:linear-gradient(135deg, #72BAAE, #2B8C7B); color:white; border-radius:50%; margin-left:12px; font-weight:600; font-family:system-ui;">C</span>
                                    <span class="option-text">...</span>
                                </button>
                            </div>

                            <!-- Quiz Feedback -->
                            <div id="hifdh-feedback" style="margin-top:16px; padding:16px; border-radius:12px; font-weight:500; display:none; text-align:center;">
                                <div id="feedback-icon" style="font-size:2.5em; margin-bottom:8px;"></div>
                                <div id="feedback-text" style="font-size:1em;"></div>
                                <button id="quiz-next-btn" style="margin-top:12px; padding:10px 24px; background:linear-gradient(135deg, #72BAAE, #2B8C7B); color:white; border:none; border-radius:8px; font-weight:600; cursor:pointer; display:none;">
                                    <span data-i18n="hifdh.nextQuestion">Next Question</span> ‚Üí
                                </button>
                            </div>
                        </div>

                        <!-- Listen Area -->
                        <div id="hifdh-listen-area" style="display:none; margin-top:16px;">
                            <div style="display:flex; gap:8px; justify-content:center; flex-wrap:wrap;">
                                <button id="hifdh-play" class="secondary-button" style="padding:10px 20px;"><span data-i18n="hifdh.play">‚ñ∂Ô∏è Play</span></button>
                                <button id="hifdh-repeat" class="secondary-button" style="padding:10px 20px;"><span data-i18n="hifdh.repeat">üîÅ Repeat</span></button>
                                <select id="hifdh-reciter" style="padding:10px; border-radius:8px; border:2px solid rgba(114,186,174,0.3);">
                                    <option value="ar.alafasy">Mishary Rashid Alafasy</option>
                                    <option value="ar.abdulsamad">Abdul Basit Abdul Samad</option>
                                    <option value="ar.abdurrahmaansudais">Abdurrahman As-Sudais</option>
                                    <option value="ar.mahermuaiqly">Maher Al-Muaiqly</option>
                                    <option value="ar.minshawi">Mohamed Siddiq El-Minshawi</option>
                                    <option value="ar.ahmedajamy">Ahmed Al-Ajamy</option>
                                    <option value="ar.hudhaify">Ali Al-Huthaifi</option>
                                </select>
                            </div>
                            <div id="hifdh-audio-status" style="text-align:center; margin-top:8px; font-size:0.85em; color:#666;"></div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div style="display:flex; gap:8px; justify-content:center; margin-top:14px; flex-wrap:wrap;">
                        <button id="hifdh-prev" class="secondary-button" style="padding:10px 16px; display:flex; align-items:center; gap:6px;"><i data-lucide="chevron-left"></i> <span data-i18n="hifdh.prev">Prev</span></button>
                        <button id="hifdh-mark" class="secondary-button" style="padding:10px 16px; background:linear-gradient(135deg, #A8EBD8 0%, #72BAAE 100%); color:white; border:none; display:flex; align-items:center; gap:6px;">
                            <span id="hifdh-mark-icon"><i data-lucide="square"></i></span> <span data-i18n="hifdh.markMemorized">Mark Memorized</span>
                        </button>
                        <button id="hifdh-next" class="secondary-button" style="padding:10px 16px; display:flex; align-items:center; gap:6px;"><span data-i18n="hifdh.next">Next</span> <i data-lucide="chevron-right"></i></button>
                    </div>

                    <!-- Bottom Actions -->
                    <div style="display:flex; gap:8px; margin-top:12px; justify-content:center;">
                        <button id="hifdh-reset" class="secondary-button" style="font-size:0.85em; padding:8px 12px; display:flex; align-items:center; gap:6px;"><i data-lucide="rotate-ccw"></i> <span data-i18n="hifdh.reset">Reset Progress</span></button>
                        <button id="hifdh-random" class="secondary-button" style="font-size:0.85em; padding:8px 12px; display:flex; align-items:center; gap:6px;"><i data-lucide="shuffle"></i> <span data-i18n="popup.refresh">Random Ayah</span></button>
                    </div>

                    <!-- Keyboard Shortcuts Hint -->
                    <div style="margin-top:12px; text-align:center; font-size:0.75em; color:#888;">
                        ‚å®Ô∏è Use <kbd style="background:#eee; padding:2px 6px; border-radius:4px;">‚Üê</kbd> <kbd style="background:#eee; padding:2px 6px; border-radius:4px;">‚Üí</kbd> arrow keys to navigate
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings-tab">
                <div class="settings-container">
                    <div class="setting-group">
                        <h3 data-i18n="options.notificationSection">Notifications</h3>
                        <label class="setting-item">
                            <input type="checkbox" id="notifications-enabled">
                            <span class="checkmark"></span>
                            <span data-i18n="options.enableNotifications">Enable notifications</span>
                        </label>
                        
                        <div class="notification-frequency" id="notification-settings">
                            <label class="setting-item">
                                <span class="setting-label" data-i18n="options.notificationInterval">Frequency:</span>
                                <select id="notification-frequency">
                                    <option value="15">Every 15 minutes</option>
                                    <option value="30">Every 30 minutes</option>
                                    <option value="60" selected>Every hour</option>
                                    <option value="120">Every 2 hours</option>
                                    <option value="180">Every 3 hours</option>
                                    <option value="360">Every 6 hours</option>
                                    <option value="720">Every 12 hours</option>
                                    <option value="1440">Daily</option>
                                </select>
                            </label>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3 data-i18n="options.displaySection">Display</h3>
                        <label class="setting-item">
                            <input type="checkbox" id="show-arabic" checked>
                            <span class="checkmark"></span>
                            <span data-i18n="options.showArabic">Show Arabic text</span>
                        </label>
                        
                        <label class="setting-item">
                            <input type="checkbox" id="show-translation" checked>
                            <span class="checkmark"></span>
                            <span data-i18n="options.showTranslation">Show English translation</span>
                        </label>
                    </div>

                    <div class="setting-group">
                        <div style="display:flex; gap:8px; flex-wrap:wrap;">
                            <button class="options-button" id="open-options">
                                <span data-i18n="popup.settings">Open Advanced Settings</span>
                            </button>
                            <button class="options-button" id="export-data">
                                <span data-i18n="options.exportSettings">Export Data</span>
                            </button>
                            <button class="options-button" id="help-button">
                                <span>Help</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p data-i18n="popup.footer">May Allah grant you peace and tranquility</p>
        </footer>
    </div>

    <!-- Resize Handle -->
    <div class="resize-handle" title="Drag to resize">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 1L1 15M15 6L6 15M15 11L11 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
    </div>

    <script src="config.js"></script>
    <script src="translations.js"></script>
    <script src="init-icons.js"></script>
    <script src="ai.js"></script>
    <script src="favorites-analyzer.js"></script>
    <script src="popup.js"></script>
</body>
</html>