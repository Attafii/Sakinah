<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sakinah</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="logo">
                <span class="arabic">ÿ≥ŸÉŸäŸÜÿ©</span>
                <span class="english">Sakinah</span>
            </h1>
            <p class="subtitle">Find peace through the Qur'an</p>
        </header>

        <!-- Tab Navigation -->
        <nav class="tabs">
            <button class="tab-button active" data-tab="random">
                <span class="tab-icon">üìñ</span>
                Random Ayah
            </button>
            <button class="tab-button" data-tab="ahadith">
                <span class="tab-icon">üïã</span>
                Ahadith
            </button>
            <button class="tab-button" data-tab="ai-guide">
                <span class="tab-icon">ü§≤</span>
                AI Guide
            </button>
                <button class="tab-button" data-tab="favorites">
                    <span class="tab-icon">‚ù§Ô∏è</span>
                    Favorites
                </button>
            <button class="tab-button" data-tab="hifdh">
                <span class="tab-icon">üéØ</span>
                Hifdh
            </button>
            <button class="tab-button" data-tab="settings">
                <span class="tab-icon">‚öôÔ∏è</span>
                Settings
            </button>
        </nav>

        <!-- Tab Content -->
        <main class="content">
            <!-- Random Ayah Tab -->
            <div class="tab-content active" id="random-tab">
                <div class="ayah-container">
                    <div class="ayah-loading" id="ayah-loading">
                        <div class="spinner"></div>
                        <p>Loading Ayah...</p>
                    </div>
                    <div class="ayah-content" id="ayah-content" style="display: none;">
                        <div class="ayah-arabic" id="ayah-arabic"></div>
                        <div class="ayah-translation" id="ayah-translation"></div>
                        <div class="ayah-reference" id="ayah-reference"></div>
                    </div>
                </div>
                <div style="display:flex; gap:8px; justify-content:center; margin-top:12px; flex-wrap:wrap;">
                    <button class="refresh-button" id="refresh-ayah" aria-label="New Ayah">
                    <span>üîÑ</span>
                    New Ayah
                    </button>
                    <button class="icon-button" id="save-favorite" aria-label="Save Ayah to favorites" title="Save to favorites">ü§ç</button>
                    <button class="secondary-button" id="explain-ayah" aria-label="Explain this Ayah with AI" style="background:linear-gradient(135deg, #A8EBD8 0%, #72BAAE 100%); color:white; border:none;">ü§ñ Explain</button>
                </div>
                <div id="ayah-explanation" style="display:none; margin-top:16px; padding:16px; background:linear-gradient(135deg, rgba(168, 235, 216, 0.2) 0%, rgba(114, 186, 174, 0.15) 100%); border-radius:12px; border-left:4px solid #72BAAE;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                        <h4 style="margin:0; color:#2B8C7B;">ü§ñ AI Explanation</h4>
                        <button id="close-ayah-explanation" style="background:none; border:none; cursor:pointer; font-size:18px; color:#666;">‚úñ</button>
                    </div>
                    <div id="ayah-explanation-content" style="line-height:1.8; color:#333;"></div>
                </div>
            </div>

            <!-- AI Guide Tab -->
            <div class="tab-content" id="ai-guide-tab">
                <div class="ai-guide-container">
                    <h3>How are you feeling?</h3>
                    <p class="guide-instruction">
                        Describe your current emotional or spiritual state, and we'll suggest the most relevant Ayah for you.
                    </p>
                    <textarea 
                        id="emotional-state" 
                        placeholder="I'm feeling anxious about my future..."
                        maxlength="500"
                    ></textarea>
                    <div class="char-count">
                        <span id="char-count">0</span>/500
                    </div>
                    <!-- Detected emotions indicator (click a tag to request a verse for that emotion) -->
                    <div id="ai-detected" class="ai-detected" style="display:none; margin-top:8px; font-size:0.9em; color:#2B8C7B;">
                        <span id="ai-detected-label" style="display:block; font-weight:600; margin-bottom:6px;">Detected:</span>
                        <div id="ai-detected-chips" style="display:flex; gap:6px; flex-wrap:wrap;"></div>
                    </div>
                    <div class="char-count">
                        <span id="char-count">0</span>/500
                    </div>
                    <button class="guide-button" id="get-guidance">
                        Find Guidance
                    </button>
                    
                    <div class="ai-result" id="ai-result" style="display: none;">
                        <div class="suggested-ayah">
                            <h4>Suggested Ayah for you:</h4>
                            <div class="ayah-arabic" id="ai-ayah-arabic"></div>
                            <div class="ayah-translation" id="ai-ayah-translation"></div>
                            <div class="ayah-reference" id="ai-ayah-reference"></div>
                            <div class="ai-explanation" id="ai-explanation"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ahadith Tab -->
            <div class="tab-content" id="ahadith-tab">
                <div class="hadith-container">
                    <div class="ayah-container">
                        <div class="ayah-loading" id="hadith-loading">
                            <div class="spinner"></div>
                            <p>Loading Hadith...</p>
                        </div>
                        <div class="ayah-content" id="hadith-content" style="display: none;">
                            <div class="ayah-arabic" id="hadith-arabic"></div>
                            <div class="ayah-translation" id="hadith-translation"></div>
                            <div class="ayah-reference" id="hadith-reference"></div>
                        </div>
                    </div>

                    <div style="display:flex; gap:8px; justify-content:center; margin-top:12px; flex-wrap:wrap; align-items:center;">
                        <button class="refresh-button" id="hadith-random" aria-label="New Hadith">
                            <span>üîÑ</span>
                            New Hadith
                        </button>
                        <button class="icon-button" id="save-hadith-favorite" aria-label="Save Hadith to favorites" title="Save to favorites">ü§ç</button>
                        <button class="secondary-button" id="explain-hadith" style="background:linear-gradient(135deg, #A8EBD8 0%, #72BAAE 100%); color:white; border:none;">ü§ñ Explain</button>
                    </div>
                    <div id="hadith-explanation" style="display:none; margin-top:16px; padding:16px; background:linear-gradient(135deg, rgba(168, 235, 216, 0.2) 0%, rgba(114, 186, 174, 0.15) 100%); border-radius:12px; border-left:4px solid #72BAAE;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                            <h4 style="margin:0; color:#2B8C7B;">ü§ñ AI Explanation</h4>
                            <button id="close-hadith-explanation" style="background:none; border:none; cursor:pointer; font-size:18px; color:#666;">‚úñ</button>
                        </div>
                        <div id="hadith-explanation-content" style="line-height:1.8; color:#333;"></div>
                    </div>
                </div>
            </div>

            <!-- Hifdh (Memorization) Tab -->
            <div class="tab-content" id="hifdh-tab">
                <div class="hifdh-container">
                    <h3 style="color:#2B8C7B; margin-bottom:16px;">üéØ Hifdh ‚Äî Memorize the Qur'an</h3>
                    <div style="display:flex; gap:8px; margin-bottom:12px; align-items:center;">
                        <label for="surah-select" style="font-size:0.95em; color:#2B8C7B; font-weight:600;">Choose Surah:</label>
                        <select id="surah-select" style="flex:1; padding:10px 14px; border-radius:12px; border:2px solid rgba(114, 186, 174, 0.3); background:white; cursor:pointer; transition:all 0.3s ease;"></select>
                    </div>

                    <div style="display:flex; gap:8px; margin-bottom:12px; flex-wrap:wrap;">
                        <button id="hifdh-learn" class="secondary-button">üìñ Learn</button>
                        <button id="hifdh-quiz" class="secondary-button">üìù Quiz</button>
                        <button id="hifdh-reset" class="secondary-button">üîÑ Reset</button>
                    </div>

                    <div id="hifdh-progress" style="margin-bottom:12px; color:#2B8C7B; font-weight:500; padding:10px; background:linear-gradient(135deg, rgba(168, 235, 216, 0.2) 0%, rgba(114, 186, 174, 0.15) 100%); border-radius:8px;">No Surah selected.</div>

                    <div id="hifdh-display" style="border:2px solid rgba(114, 186, 174, 0.2); padding:16px; border-radius:12px; background:linear-gradient(145deg, #fff 0%, #f8faf9 100%); box-shadow:0 4px 15px rgba(114, 186, 174, 0.1);">
                        <div id="hifdh-arabic" style="direction:rtl; font-size:1.25em; font-family:'Scheherazade', 'Amiri', serif; margin-bottom:12px; color:#1a3a36; line-height:1.8;">Select a Surah to begin.</div>
                        <div id="hifdh-translation" style="font-size:0.95em; color:#495057; margin-bottom:12px; line-height:1.7;"></div>

                        <div id="hifdh-quiz-area" style="display:none; margin-bottom:12px;">
                            <label for="hifdh-answer" style="display:block; margin-bottom:8px; color:#2B8C7B; font-weight:600;">Type the Arabic text (or translation) to check:</label>
                            <textarea id="hifdh-answer" rows="3" style="width:100%; padding:12px; margin-top:6px; border-radius:10px; border:2px solid rgba(114, 186, 174, 0.3); resize:vertical; font-family:inherit; transition:all 0.3s ease;"></textarea>
                            <div style="display:flex; gap:8px; margin-top:10px;">
                                <button id="hifdh-check" class="secondary-button">‚úîÔ∏è Check Answer</button>
                                <button id="hifdh-reveal" class="secondary-button">üëÅÔ∏è Reveal</button>
                            </div>
                            <div id="hifdh-feedback" style="margin-top:10px; padding:10px; border-radius:8px; font-weight:500;"></div>
                        </div>

                        <div style="display:flex; gap:8px; justify-content:center; margin-top:14px; flex-wrap:wrap;">
                            <button id="hifdh-prev" class="secondary-button">‚óÄ Prev</button>
                            <button id="hifdh-next" class="secondary-button">Next ‚ñ∂</button>
                            <button id="hifdh-mark" class="secondary-button" style="background:linear-gradient(135deg, #A8EBD8 0%, #72BAAE 100%); color:white; border:none;">‚úÖ Mark Memorized</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings-tab">
                <div class="settings-container">
                    <div class="setting-group">
                        <h3>Notifications</h3>
                        <label class="setting-item">
                            <input type="checkbox" id="notifications-enabled">
                            <span class="checkmark"></span>
                            Enable notifications
                        </label>
                        
                        <div class="notification-frequency" id="notification-settings">
                            <label class="setting-item">
                                <span class="setting-label">Frequency:</span>
                                <select id="notification-frequency">
                                    <option value="15">Every 15 minutes</option>
                                    <option value="30">Every 30 minutes</option>
                                    <option value="60" selected>Every hour</option>
                                    <option value="120">Every 2 hours</option>
                                    <option value="180">Every 3 hours</option>
                                    <option value="360">Every 6 hours</option>
                                    <option value="720">Every 12 hours</option>
                                    <option value="1440">Daily</option>
                                </select>
                            </label>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3>Display</h3>
                        <label class="setting-item">
                            <input type="checkbox" id="show-arabic" checked>
                            <span class="checkmark"></span>
                            Show Arabic text
                        </label>
                        
                        <label class="setting-item">
                            <input type="checkbox" id="show-translation" checked>
                            <span class="checkmark"></span>
                            Show English translation
                        </label>
                    </div>

                    <div class="setting-group">
                        <div style="display:flex; gap:8px; flex-wrap:wrap;">
                            <button class="options-button" id="open-options">
                                Open Advanced Settings
                            </button>
                            <button class="options-button" id="test-notification">
                                Test Notification
                            </button>
                            <button class="options-button" id="export-data">
                                Export Data
                            </button>
                            <button class="options-button" id="help-button">
                                Help
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>May Allah grant you peace and tranquility</p>
        </footer>
    </div>

    <script src="config.js"></script>
    <script src="ai.js"></script>
    <script src="favorites-analyzer.js"></script>
    <script src="popup.js"></script>
</body>
</html>